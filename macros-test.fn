(

; (defmacro _foo (x) 1)
; (eq 1 (_foo 'bar))

(eql '(if a a-case
      (if b b-case
      (if c c-case
            (error "No match."))))
     (macroexpand
      '(cond (a a-case)
             (b b-case)
             (c c-case))))

;; Does the hand-written defmacro
;; macro work?
(eql
 '(def *macros*
     (acons 'and
	    (lambda (x)
	      (list 'if (first x)
		    (first (rest x))
		    'false))
	    *macros*))
 (macroexpand-rec
  '(defmacro and (x)
    (list 'if (first x)
          (first (rest x))
          'false))))

(eql
 '(if a (if b c))
 (macroexpand '(and a b c)))

(eql 'a (macroexpand '(and a)))

(eql
 '(if a true (if b true c))
 (macroexpand '(or a b c)))

)
