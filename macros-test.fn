(

(eql '(if a a-case
      (if b b-case
      (if c c-case
            (error "No match."))))
     (macroexpand
      '(cond (a a-case)
             (b b-case)
             (c c-case))))

;; Does the hand-written defmacro
;; macro work?
(eql
 '(def *macros*
     (acons 'and
	    (lambda (x)
	      (list 'if (first x)
		    (first (rest x))
		    'false))
	    *macros*))
 (macroexpand-rec
  '(defmacro and (x)
    (list 'if (first x)
          (first (rest x))
          'false))))

(eql
 '(if a (if b c false) false)
 (macroexpand '(and a b c)))

(eql 'a (macroexpand '(and a)))

(eql
 '(if a true (if b true c))
 (macroexpand '(or a b c)))

;; Backquote
(eql '(quote x)
     (macroexpand '(backquote x)))

(eql '(append (list 'x))
     (macroexpand '(backquote (x))))

(eql '(append (list x))
     (macroexpand '(backquote ((unquote x)))))

(eql '(append xs)
     (macroexpand '(backquote ((unquote-list xs)))))

(eql
 '(append (list 'foo) (list bar))
 (macroexpand '(backquote (foo (unquote bar)))))

(eql
 '(append (list 'foo) (list 1 2 3) (list 'bar))
 (macroexpand '(backquote (foo (unquote-list (list 1 2 3)) bar))))
)
